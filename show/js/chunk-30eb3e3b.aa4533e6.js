(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30eb3e3b"],{"2da1":function(e,t,o){"use strict";o.r(t);for(var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"three-content",attrs:{id:"three-dom"}},[o("el-button",{staticStyle:{position:"absolute",top:"20px",right:"20px"},attrs:{type:"primary"},on:{click:e.set}},[e._v("模拟告警设置")]),o("el-dialog",{attrs:{top:"0vh",center:!0,title:"告警设置",visible:e.dialogVisible,width:"1450px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("div",[o("h3",[e._v("触发告警设置")]),o("div",[o("el-checkbox-group",{model:{value:e.equipmentList,callback:function(t){e.equipmentList=t},expression:"equipmentList"}},[e._l(e.equipment,(function(t,i){return[o("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))]),o("el-select",{staticStyle:{width:"75px","margin-right":"10px","margin-bottom":"3px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.alarm[i],callback:function(t){e.$set(e.alarm,i,t)},expression:"alarm[i]"}},e._l(e.alarmInfo,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})))]}))],2)],1),o("h3",[e._v("解除告警设置")]),o("div",[o("el-checkbox-group",{model:{value:e.equipmentList1,callback:function(t){e.equipmentList1=t},expression:"equipmentList1"}},[e._l(e.equipment,(function(t,i){return[o("el-checkbox",{key:t.id,staticStyle:{"margin-bottom":"5px"},attrs:{label:t.id}},[e._v(e._s(t.name))])]}))],2)],1)]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.sure}},[e._v("确 定")])],1)])],1)},n=[],a=(o("14b9"),o("6b54"),o("7f7f"),o("ac6a"),o("d4ec")),r=o("bee2"),s=o("5a89"),l=(o("2176"),o("34ad"),o("9e5c"),o("e642")),d=(o("5a15"),o("0dc0"),o("4086")),h=(o("8710"),o("4721")),c=function(){function e(t,o){Object(a["a"])(this,e),this.props=t,this.ThreeData=o,this.dataJson=o,this.objList=o.objects||[],this.eventList=o.events||{},this.btnList=o.btns||[],this.renderer=null,this.scene=null,this.camera=null,this.objects=[],this.equipment=[],this.sprite=[],this.cabinet=[],this.dom=document.getElementById(this.props.domID),this.dbclick=0,this.mouseClick=new s["Vector2"],this.raycaster=new s["Raycaster"],this.lastElement=null,this.tipTimer=null,this.tooltip=null,this.lastEvent=null,this.tooltipBG="#ACDEFE",this.progressSuccess=0,this.loadtimer=null,this.BASE_PATH="./rack/",this.commonFunc={_this:this,hasObj:function(e){return null!=e&&"undefined"!=typeof e},findObject:function(e){var t=null;return this.objects.forEach((function(o,i){if(null!=o.name&&""!=o.name&&o.name==e)return t=o,t})),t},getPath:function(e){return this._this.BASE_PATH+e},guid:function(){return this.guidRandom()+this.guidRandom()+"-"+this.guidRandom()+"-"+this.guidRandom()+"-"+this.guidRandom()+"-"+this.guidRandom()+this.guidRandom()+this.guidRandom()},guidRandom:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)}}}return Object(r["a"])(e,[{key:"init",value:function(){this.initScene(),this.initRenderer(),this.initCamera(),this.initLight(),this.render(),this.setControl(),this.InitData(),this.renderer.domElement.addEventListener("mousedown",this.onDocumentMouseDown.bind(this),!1),this.renderer.domElement.addEventListener("mousemove",this.onDocumentMouseMove.bind(this),!1)}},{key:"initRenderer",value:function(){this.renderer=new s["WebGLRenderer"]({antialias:!0,alpha:!0}),this.renderer.setSize(this.dom.offsetWidth,this.dom.offsetHeight),this.dom.appendChild(this.renderer.domElement)}},{key:"initCamera",value:function(){this.camera=new s["PerspectiveCamera"](45,this.dom.offsetWidth/this.dom.offsetHeight,1,1e5),this.camera.name="mainCamera",this.camera.position.set(1e3,1e3,2800),this.camera.lookAt({x:0,y:0,z:0}),this.scene.add(this.camera)}},{key:"initScene",value:function(){this.scene=new s["Scene"]}},{key:"initLight",value:function(){var e=new s["AmbientLight"](13421772);e.position.set(0,0,0),this.scene.add(e);var t=new s["PointLight"](5592405);t.shadow.camera.near=1,t.shadow.camera.far=5e3,t.position.set(0,3500,0),t.castShadow=!0,this.scene.add(t)}},{key:"render",value:function(){this.animate()}},{key:"animate",value:function(){requestAnimationFrame(this.render.bind(this)),this.renderer.render(this.scene,this.camera)}},{key:"setHelper",value:function(){var e=new s["AxisHelper"](5);this.scene.add(e)}},{key:"setControl",value:function(){this.controls=new h["a"](this.camera,this.dom),this.controls.update()}},{key:"InitData",value:function(){if(this.objList.length>0){for(var e=0;e<this.objList.length;e++)this.InitAddObject(this.objList[e]);this.InitTooltip()}}},{key:"Loading",value:function(){var e=document.createElement("div");e.setAttribute("id","loading"),e.style.display="block",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.width="100%",e.style.height="100%",e.style.fontSize="30px",e.style.zIndex="999",e.style.background="rgba(0,0,0,0.65)";var t=document.createElement("div");t.innerHTML="模型加载中...",t.style.top="40%",t.style.position="absolute",t.style.width="100%",t.style.textAlign="center",e.appendChild(t),this.dom.appendChild(e)}},{key:"LoadSuccess",value:function(){var e=this;if(3==this.progressSuccess){var t=this.dom.querySelector("#loading");t.style.display="none",clearTimeout(this.loadtimer)}else this.loadtimer=setTimeout((function(){e.LoadSuccess()}),1e3)}},{key:"InitTooltip",value:function(){this.tooltip=document.createElement("div"),this.tooltip.setAttribute("id","tooltip"),this.tooltip.style.display="none",this.tooltip.style.position="absolute",this.tooltip.style.color="#000",this.tooltip.style.maxWidth="200px",this.tooltip.style.width="32px",this.tooltip.style.height="auto",this.tooltip.style.lineHeight="22px",this.tooltip.style.textAlign="center",this.tooltip.style.padding="10px",this.tooltip.style.background=this.tooltipBG,this.tooltip.style.opacity=.8,this.tooltip.style["border-radius"]="5px";var e=document.createElement("div");e.setAttribute("id","tipdiv");var t=document.createElement("span");t.style.marginLeft="50%",t.style.bottom="-10px",t.style.left="-10px",t.style.position="absolute",t.style.borderTop="10px solid "+this.tooltipBG,t.style.borderLeft="10px solid transparent",t.style.borderRight="10px solid transparent",this.tooltip.appendChild(t),this.tooltip.appendChild(e),this.dom.appendChild(this.tooltip)}},{key:"InitAddObject",value:function(e){if(null==e.show||"undefined"==typeof e.show||e.show){var t=null;switch(e.objType){case"cube":t=this.createCube(e),this.addObject(t,"scene");break;case"face":this.CreateFace(e);break;case"wall":this.CreateWall(e,"wall");break;case"objCamera":this.createObjCamera(e);break;case"rack":this.CreateWall(e,"rack");break}}}},{key:"createObjCamera",value:function(e){var t=this,o=new d["a"];o.load(t.commonFunc.getPath("camera/camera.mtl"),(function(o){o.preload();var i=new l["a"];i.setMaterials(o),i.load(t.commonFunc.getPath("camera/camera.obj"),(function(o){e.childrens.forEach((function(i){var n=o.clone();n.objHandle||(i.objHandle?n.objHandle=i.objHandle:e.objHandle&&(n.objHandle=e.objHandle)),n=t.handleObj(n),n.position.set(i.x||0,i.y||0,i.z||0),t.scene.add(n)})),t.progressSuccess+=1}),t.onProgress,t.onError)}))}},{key:"CreateFace",value:function(e){var t=this,o={width:e.width||40,height:e.height||100,depth:e.depth||400,rotation:e.rotation,x:e.x||0,y:e.y||0,z:e.z||0,uuid:e.uuid,name:e.name,style:{skinColor:e.style.skinColor||401506,edgeColor:e.style.edgeColor||1399980}},i=this.createCube(o);t.commonFunc.hasObj(e.childrens)&&e.childrens.length>0&&e.childrens.forEach((function(e,n){var a;a="line"==e.objType?t.CreateLine(e):"faceCube"==e.objType?t.CreateFaceCube(e):t.CreateHole(e),i=t.mergeModel(e.op,i,a,o.style.skinColor)})),t.addObject(i,"scene")}},{key:"CreateFaceCube",value:function(e){var t=e.width||10,o=e.depth||100,i=e.height||100,n=((e.startDot.x||0)+(e.endDot.x||0))/2,a=((e.startDot.y||0)+(e.endDot.y||0))/2,r=((e.startDot.z||0)+(e.endDot.z||0))/2;e.startDot.z==e.endDot.z?(t=Math.abs(e.startDot.x-e.endDot.x),o=e.depth||commonDepth):e.startDot.x==e.endDot.x&&(t=e.depth||commonDepth,o=Math.abs(e.startDot.z-e.endDot.z));var s={width:t,height:e.height||i,depth:o,rotation:e.rotation,x:n,y:a,z:r,uuid:e.uuid,name:e.name,style:{skinColor:e.skin.skinColor,edgeColor:e.skin.edgeColor,skin:e.skin,transparent:e.skin.transparent,opacity:e.skin.opacity}};return this.createCube(s)}},{key:"CreateWireCube",value:function(e){var t={width:e.width||10,height:e.height||10,depth:e.depth||10,rotation:e.rotation,x:e.x||0,y:e.y||0,z:e.z||0,uuid:e.uuid,name:e.name,style:{skinColor:e.skin.skinColor,edgeColor:e.skin.edgeColor,skin:e.skin,transparent:e.skin.transparent,opacity:e.skin.opacity}},o=this.createCube(t);return o}},{key:"CreateWall",value:function(e,t){var o=this,i=e.depth||40,n=e.height||100,a=e.width||300,r=e.style.skinColor||9991439,s=e.style.edgeColor||"",l=e.style.transparent||!1,d=e.style.opacity||1;e.childrens.forEach((function(e,h){var c,u,p,m=a,y=e.depth||i;e.startDot&&e.endDot&&(c=((e.startDot.x||0)+(e.endDot.x||0))/2,u=((e.startDot.y||0)+(e.endDot.y||0))/2,p=((e.startDot.z||0)+(e.endDot.z||0))/2,e.startDot.z==e.endDot.z?(m=Math.abs(e.startDot.x-e.endDot.x),y=e.depth||i):e.startDot.x==e.endDot.x&&(m=e.depth||i,y=Math.abs(e.startDot.z-e.endDot.z)));var g={width:e.width||m,height:e.height||n,depth:e.depth||y,rotation:e.rotation,x:c||e.x,y:u||e.y,z:p||e.z,uuid:e.uuid,name:e.name,style:{skinColor:r,edgeColor:s||e.skin.edgeColor,skin:e.skin,transparent:l,opacity:d}},f=o.createCube(g);o.commonFunc.hasObj(e.childrens)&&e.childrens.length>0&&e.childrens.forEach((function(e,t){var i;i="wireCube"==e.objType?o.CreateWireCube(e):"triangle"==e.objType?o.CreateTriangle(e):o.CreateHole(e),f=o.mergeModel(e.op,f,i,r,e.skin.edgeColor)})),"wall"==t?o.addObject(f):"rack"==t&&(f.name=e.name,f.uuid=e.uuid,f.data=e.data||{name:e.name,alarmInfo:[],tipInfo:e.name},o.addObject(f),o.equipment.push(f))}))}},{key:"mergeModel",value:function(e,t,o,i,n){if(!e)return this.addObject(o,"scene"),t;var a=new ThreeBSP(t),r=new ThreeBSP(o),l=null;if("-"==e)l=a.subtract(r);else{if("+"==e)return o.updateMatrix(),t.geometry.merge(o.geometry,o.matrix),n?this.setEdgesGeometry(t,n):t;if("&"!=e)return this.addObject(o,"scene"),t;l=a.intersect(r)}var d=l.toMesh();d.material.flatShading=s["FlatShading"],d.geometry.computeFaceNormals(),d.geometry.computeVertexNormals(),d.uuid=t.uuid+e+o.uuid,d.name=t.name+e+o.name,d.material.needsUpdate=!0,d.geometry.buffersNeedUpdate=!0,d.geometry.uvsNeedUpdate=!0,d.material=t.material;for(var h=0;h<d.geometry.faces.length/2;h++){for(var c=!1,u=0;u<t.geometry.faces;u++)d.geometry.faces[h].vertexNormals[0].x===t.geometry.faces[u].vertexNormals[0].x&&d.geometry.faces[h].vertexNormals[0].y===t.geometry.faces[u].vertexNormals[0].y&&d.geometry.faces[h].vertexNormals[0].z===t.geometry.faces[u].vertexNormals[0].z&&d.geometry.faces[h].vertexNormals[1].x===t.geometry.faces[u].vertexNormals[1].x&&d.geometry.faces[h].vertexNormals[1].y===t.geometry.faces[u].vertexNormals[1].y&&d.geometry.faces[h].vertexNormals[1].z===t.geometry.faces[u].vertexNormals[1].z&&d.geometry.faces[h].vertexNormals[2].x===t.geometry.faces[u].vertexNormals[2].x&&d.geometry.faces[h].vertexNormals[2].y===t.geometry.faces[u].vertexNormals[2].y&&d.geometry.faces[h].vertexNormals[2].z===t.geometry.faces[u].vertexNormals[2].z&&(d.geometry.faces[2*h].color.setHex(i),d.geometry.faces[2*h].materialIndex=t.geometry.faces[u].materialIndex,d.geometry.faces[2*h+1].color.setHex(i),d.geometry.faces[2*h+1].materialIndex=t.geometry.faces[u].materialIndex);if(0==c){for(u=0;u<o.geometry.faces.length;u++)d.geometry.faces[h].vertexNormals[0].x===o.geometry.faces[u].vertexNormals[0].x&&d.geometry.faces[h].vertexNormals[0].y===o.geometry.faces[u].vertexNormals[0].y&&d.geometry.faces[h].vertexNormals[0].z===o.geometry.faces[u].vertexNormals[0].z&&d.geometry.faces[h].vertexNormals[1].x===o.geometry.faces[u].vertexNormals[1].x&&d.geometry.faces[h].vertexNormals[1].y===o.geometry.faces[u].vertexNormals[1].y&&d.geometry.faces[h].vertexNormals[1].z===o.geometry.faces[u].vertexNormals[1].z&&d.geometry.faces[h].vertexNormals[2].x===o.geometry.faces[u].vertexNormals[2].x&&d.geometry.faces[h].vertexNormals[2].y===o.geometry.faces[u].vertexNormals[2].y&&d.geometry.faces[h].vertexNormals[2].z===o.geometry.faces[u].vertexNormals[2].z&&(d.geometry.faces[2*h].color.setHex(i),d.geometry.faces[2*h].materialIndex=o.geometry.faces[u].materialIndex,d.geometry.faces[2*h+1].color.setHex(i),d.geometry.faces[2*h+1].materialIndex=o.geometry.faces[u].materialIndex);d.geometry.faces[2*h].color.setHex(i),d.geometry.faces[2*h+1].color.setHex(i)}}return d.castShadow=!0,d.receiveShadow=!0,d}},{key:"CreateLine",value:function(e){var t=new s["Geometry"];t.vertices.push(new s["Vector3"](e.startDot.x,e.startDot.y,e.startDot.z),new s["Vector3"](e.endDot.x,e.endDot.y,e.endDot.z));var o=new s["LineBasicMaterial"]({vertexColors:!1,color:e.skinColor,linewidth:2});return new s["Line"](t,o)}},{key:"CreateHole",value:function(e){var t=40,o=100,i=300,n=401506,a=i,r=e.depth||t;if(e.startDot&&e.endDot){var s=((e.startDot.x||0)+(e.endDot.x||0))/2,l=((e.startDot.y||0)+(e.endDot.y||0))/2,d=((e.startDot.z||0)+(e.endDot.z||0))/2;e.startDot.z==e.endDot.z?(a=Math.abs(e.startDot.x-e.endDot.x),r=e.depth||t):e.startDot.x==e.endDot.x&&(a=e.depth||t,r=Math.abs(e.startDot.z-e.endDot.z))}var h={width:e.width||a,height:e.height||o,depth:e.depth||r,rotation:e.rotation,uuid:e.uuid,name:e.name,objType:e.objType,x:s||e.x,y:l||e.y,z:d||e.z,style:{skinColor:e.skinColor||n,edgeColor:e.skin.edgeColor||"",skin:e.skin}},c=this.createCube(h);return c}},{key:"setEdgesGeometry",value:function(e,t){var o=new s["EdgesGeometry"](e.geometry,1),i=new s["LineSegments"](o,new s["LineBasicMaterial"]({color:t}));return e.add(i),e}},{key:"createCube",value:function(e){for(var t=e.width||1e3,o=e.height||10,i=e.depth||t,n=e.x||0,a=e.y||0,r=e.z||0,l=e.style.hasOwnProperty("skinColor")?e.style.skinColor:"",d=e.style.hasOwnProperty("edgeColor")?e.style.edgeColor:"",h=new s["CubeGeometry"](t,o,i,0,0,1),c=0;c<h.faces.length;c+=2)h.faces[c].color.setHex(l),h.faces[c+1].color.setHex(l);var u={vertexColors:s["FaceColors"]},p=u,m=u,y=u,g=u,f=u;if(null!=e.style&&"undefined"!=typeof e.style&&null!=e.style.skin&&"undefined"!=typeof e.style.skin){null!=e.style.skin.opacity&&"undefined"!=typeof e.style.skin.opacity&&e.style.skin.opacity;var k=e.style.skin.hasOwnProperty("skin_right")&&e.style.skin.skin_right.hasOwnProperty("skinColor")?e.style.skin.skin_right.skinColor:e.style.skin.hasOwnProperty("skinColor")?e.style.skin.skinColor:"",b=e.style.skin.hasOwnProperty("skin_left")&&e.style.skin.skin_left.hasOwnProperty("skinColor")?e.style.skin.skin_left.skinColor:e.style.skin.hasOwnProperty("skinColor")?e.style.skin.skinColor:"",v=e.style.skin.hasOwnProperty("skin_up")&&e.style.skin.skin_up.hasOwnProperty("skinColor")?e.style.skin.skin_up.skinColor:e.style.skin.hasOwnProperty("skinColor")?e.style.skin.skinColor:"",x=e.style.skin.hasOwnProperty("skin_down")&&e.style.skin.skin_down.hasOwnProperty("skinColor")?e.style.skin.skin_down.skinColor:e.style.skin.hasOwnProperty("skinColor")?e.style.skin.skinColor:"",w=e.style.skin.hasOwnProperty("skin_fore")&&e.style.skin.skin_fore.hasOwnProperty("skinColor")?e.style.skin.skin_fore.skinColor:e.style.skin.hasOwnProperty("skinColor")?e.style.skin.skinColor:"",C=e.style.skin.hasOwnProperty("skin_behind")&&e.style.skin.skin_behind.hasOwnProperty("skinColor")?e.style.skin.skin_behind.skinColor:e.style.skin.hasOwnProperty("skinColor")?e.style.skin.skinColor:"";f=this.createSkinOption(i,o,e.style.skin.skin_right,h,k,0),g=this.createSkinOption(i,o,e.style.skin.skin_left,h,b,2),u=this.createSkinOption(t,i,e.style.skin.skin_up,h,v,4),p=this.createSkinOption(t,i,e.style.skin.skin_down,h,x,6),m=this.createSkinOption(t,o,e.style.skin.skin_fore,h,w,8),y=this.createSkinOption(t,o,e.style.skin.skin_behind,h,C,10)}var z=[];z.push(new s["MeshLambertMaterial"](f)),z.push(new s["MeshLambertMaterial"](g)),z.push(new s["MeshLambertMaterial"](u)),z.push(new s["MeshLambertMaterial"](p)),z.push(new s["MeshLambertMaterial"](m)),z.push(new s["MeshLambertMaterial"](y));var D=new s["Mesh"](h,z);return D.castShadow=!0,D.receiveShadow=!0,D.needsUpdate=!0,D.uuid=e.uuid,D.name=e.name,D.position.set(n,a,r),null!=e.rotation&&"undefined"!=typeof e.rotation&&e.rotation.length>0&&e.rotation.forEach((function(e,t){switch(e.direction){case"x":D.rotateX(e.degree);break;case"y":D.rotateY(e.degree);break;case"z":D.rotateZ(e.degree);break;case"arb":D.rotateOnAxis(new s["Vector3"](e.degree[0],e.degree[1],e.degree[2]),e.degree[3]);break}})),d&&(D=this.setEdgesGeometry(D,d)),D}},{key:"createPlaneGeometry",value:function(e){var t,o=e.transparent;if(!1!==e.transparent&&(o=!0),"string"==typeof e.imgurl){var i=new s["TextureLoader"],n=e.imgurl;-1==e.imgurl.indexOf("data:image/")&&(n=this.commonFunc.getPath(e.imgurl)),t=i.load(n,(function(){}),void 0,(function(){}))}else t=new s["CanvasTexture"](e.imgurl);var a={map:t,side:e.side||s["DoubleSide"],transparent:o,opacity:e.opacity||1};e.blending&&(a.blending=s["AdditiveBlending"]);var r=new s["Mesh"](new s["PlaneGeometry"](e.width,e.height,1,1),new s["MeshBasicMaterial"](a));return r.position.x=e.x||0,r.position.y=e.y||0,r.position.z=e.z||0,null!=e.rotation&&"undefined"!=typeof e.rotation&&e.rotation.length>0&&e.rotation.forEach((function(e,t){switch(e.direction){case"x":r.rotateX(e.degree);break;case"y":r.rotateY(e.degree);break;case"z":r.rotateZ(e.degree);break;case"arb":r.rotateOnAxis(new s["Vector3"](e.degree[0],e.degree[1],e.degree[2]),e.degree[3]);break}})),r}},{key:"CreateTriangle",value:function(e){var t=e.width/2,o=e.height,i=e.depth/2,n=-e.width/2,a=0,r=-e.depth/2,l=new s["Geometry"],d=new s["Vector3"](t,o/3,i),h=new s["Vector3"](n,o/3,i),c=new s["Vector3"](n,a,i),u=new s["Vector3"](t,a,i),p=new s["Vector3"](t,o,r),m=new s["Vector3"](n,o,r),y=new s["Vector3"](n,a,r),g=new s["Vector3"](t,a,r);l.vertices.push(d,h,c,u,p,m,y,g);var f=new s["Face3"](0,3,4),k=new s["Face3"](3,7,4),b=new s["Face3"](1,5,2),v=new s["Face3"](5,6,2),x=new s["Face3"](0,4,1),w=new s["Face3"](4,5,1),C=new s["Face3"](2,6,3),z=new s["Face3"](6,7,3),D=new s["Face3"](0,1,3),j=new s["Face3"](1,2,3),O=new s["Face3"](5,4,6),S=new s["Face3"](4,7,6);l.faces.push(f,k,b,v,x,w,C,z,D,j,O,S);for(var T=0;T<l.faces.length;T+=2){Math.random();l.faces[T].color.setHex(e.skin.skinColor),l.faces[T+1].color.setHex(e.skin.skinColor)}for(var L=[],N=0;N<l.faces.length;N++){var M=new s["MeshBasicMaterial"]({vertexColors:s["FaceColors"]});L.push(M)}var _=new s["Mesh"](l,L);_.castShadow=!0,_.receiveShadow=!0,_.needsUpdate=!0,_.uuid=e.uuid,_.name=e.name,_.position.set(e.x,e.y,e.z),null!=e.rotation&&"undefined"!=typeof e.rotation&&e.rotation.length>0&&e.rotation.forEach((function(e,t){switch(e.direction){case"x":_.rotateX(e.degree);break;case"y":_.rotateY(e.degree);break;case"z":_.rotateZ(e.degree);break;case"arb":_.rotateOnAxis(new s["Vector3"](e.degree[0],e.degree[1],e.degree[2]),e.degree[3]);break}}));var P=e.skin.hasOwnProperty("edgeColor")?e.skin.edgeColor:"";return P&&(_=this.setEdgesGeometry(_,P)),_}},{key:"handleObj",value:function(e){return null!=e.objHandle&&"undefined"!=typeof e.objHandle&&e.objHandle.length>0&&e.objHandle.forEach((function(t){switch(t.direction){case"x":t.ratio&&(e.scale.x=t.ratio),t.degree&&e.rotateX(t.degree);break;case"y":t.ratio&&(e.scale.y=t.ratio),t.degree&&e.rotateY(t.degree);break;case"z":t.ratio&&(e.scale.z=t.ratio),t.degree&&e.rotateZ(t.degree);break;case"arb":t.handleScale&&3==t.handleScale.length&&e.scale.set(t.handleScale[0],t.handleScale[1],t.handleScale[2]),t.handleRotale&&4==t.handleRotale.length&&e.rotateOnAxis(new s["Vector3"](t.handleRotale[0],t.handleRotale[1],t.handleRotale[2]),t.handleRotale[3]);break}})),e}},{key:"onProgress",value:function(e){if(e.lengthComputable)e.loaded,e.total}},{key:"onError",value:function(e){}},{key:"changePivot",value:function(e,t,o,i){var n=new s["Object3D"];return n.position.set(e.position.x+t,e.position.y+o,e.position.z+i),e.position.set(-t,-o,-i),n.add(e),n}},{key:"addObject",value:function(e,t){t?("object"==t&&this.objects.push(e),"scene"==t&&this.scene.add(e)):(this.objects.push(e),this.scene.add(e))}},{key:"createSkinOption",value:function(e,t,o,i,n,a){if(this.commonFunc.hasObj(o)){if(this.commonFunc.hasObj(o.imgurl)){var r={color:n,map:this.createSkin(e,t,o),opacity:o.opacity||1};return o.transparent&&(r.transparent=o.transparent),o.blending&&(r.blending=s["AdditiveBlending"]),r}return this.commonFunc.hasObj(o.skinColor)&&(i.faces[a].color.setHex(o.skinColor),i.faces[a+1].color.setHex(o.skinColor)),{vertexColors:s["FaceColors"]}}return{vertexColors:s["FaceColors"]}}},{key:"createSkin",value:function(e,t,o){var i=128,n=128;null!=o.width&&"undefined"!=typeof o.width&&(i=o.width),null!=o.height&&"undefined"!=typeof o.height&&(n=o.height);var a=(new s["TextureLoader"]).load(this.commonFunc.getPath(o.imgurl)),r=!1;return null!=o.repeatx&&"undefined"!=typeof o.repeatx&&1==o.repeatx&&(a.wrapS=s["RepeatWrapping"],r=!0),null!=o.repeaty&&"undefined"!=typeof o.repeaty&&1==o.repeaty&&(a.wrapT=s["RepeatWrapping"],r=!0),r&&a.repeat.set(e/i,t/n),a}},{key:"updateAlarmStatus",value:function(e){console.log(e,this.equipment);for(var t=0;t<this.equipment.length;t++)for(var o=0;o<e.length;o++)e[o].devid==this.equipment[t].data.devid&&e[o].pointid==this.equipment[t].data.pointid&&this.updateCube(this.equipment[t],e[o].isalarm)}},{key:"updateCube",value:function(e,t){var o=t?16711680:401506;e.geometry.faces.forEach((function(e){e.color.setHex(o)})),e.geometry.colorsNeedUpdate=!0}},{key:"onDocumentMouseDown",value:function(e){this.dbclick++;var t=this;if(setTimeout((function(){t.dbclick=0}),500),e.preventDefault(),this.dbclick>=2){this.mouseClick.x=e.offsetX/this.dom.offsetWidth*2-1,this.mouseClick.y=-e.offsetY/this.dom.offsetHeight*2+1,this.raycaster.setFromCamera(this.mouseClick,this.camera);var o=this.raycaster.intersectObjects(this.objects);if(o.length>0){this.controls.enabled=!1;var i=o[0].object;console.log(i),null!=this.eventList&&null!=this.eventList.dbclick&&this.eventList.dbclick.length>0&&this.eventList.dbclick.forEach((function(e,o){"string"==typeof e.obj_name?e.obj_name==i.name&&e.obj_event(i,t):null==e.findObject&&"function"!=typeof e.findObject||e.findObject(i.name)&&e.obj_event(i,t)})),this.controls.enabled=!0}}}},{key:"openCloseDoor",value:function(e,t,o,i,n){console.log(e);var a="close",r=null;if(null!=e.doorState&&"undefined"!=typeof e.doorState)a=e.doorState,r=e.parent;else{console.log("add parent");var l=e.parent;r=new s["Object3D"],r.position.set(e.position.x+t,e.position.y+o,e.position.z+i),e.position.set(-t,-o,-i),r.add(e),l.add(r)}if(e.doorState="close"==a?"open":"close","left"==n||"right"==n){var d="left"==n?1:-1;"close"==e.doorState?r.rotateOnAxis(new s["Vector3"](0,1,0),.5*d*Math.PI):r.rotateOnAxis(new s["Vector3"](0,1,0),-.5*d*Math.PI)}else if("outin"==n){var h=new s["Vector3"](1,0,0);"close"==e.doorState?r.translateOnAxis(h,20-e.geometry.parameters.depth):r.translateOnAxis(h,e.geometry.parameters.depth-20)}}},{key:"openLeftDoor",value:function(e,t){this.openCloseDoor(e,-e.geometry.parameters.width/2,0,0,"left")}},{key:"openRightDoor",value:function(e,t){this.openCloseDoor(e,e.geometry.parameters.width/2,0,0,"right")}},{key:"openCabinetDoor",value:function(e,t){this.openCloseDoor(e,e.geometry.parameters.width/2,0,e.geometry.parameters.depth/2,"right")}},{key:"openEquipmentDoor",value:function(e,t){this.openCloseDoor(e,0,0,e.geometry.parameters.depth/2,"outin")}},{key:"onDocumentMouseMove",value:function(e){var t=this,o=null;this.mouseClick.x=e.offsetX/this.dom.offsetWidth*2-1,this.mouseClick.y=-e.offsetY/this.dom.offsetHeight*2+1,this.raycaster.setFromCamera(this.mouseClick,this.camera);var i=this.raycaster.intersectObjects(this.objects);if(i.length>0){var n=i[0].object;-1!=n.name.toString().indexOf("Rack")&&(o=n)}this.lastElement!=o&&(clearTimeout(this.tipTimer),o&&(this.tipTimer=setTimeout((function(){var e="";-1!=o.name.toString().indexOf("Rack")&&(console.log(o),e=o.data.tipInfo,t.tooltip.style.background=t.tooltipBG,t.tooltip.querySelector("span").style.borderTop="10px solid "+t.tooltipBG);var i=e.length;t.tooltip.querySelector("#tipdiv").innerHTML=e,t.tooltip.style.width=15*i+"px",t.tooltip.style.display="block",t.tooltip.style.left=t.lastEvent.pageX-t.tooltip.clientWidth/2+"px",t.tooltip.style.top=t.lastEvent.pageY-t.tooltip.clientHeight-15+"px"}),300))),this.lastElement=o,null==o&&t.tooltip&&(t.tooltip.style.display="none"),this.lastEvent=e}}]),e}(),u=2e3,p=1200,m=90,y=40,g=400,f=10,k=800,b=20,v=.1,x=10,w=80,C=40,z=401506,D=1399980,j={objects:[{uuid:"",name:"floor",objType:"cube",width:u,depth:p,height:m,style:{skinColor:z,edgeColor:D}},{uuid:"",name:"ladder",objType:"wall",depth:g,width:y,height:m/3,style:{skinColor:z,edgeColor:D},childrens:[{uuid:"",name:"ladder1",startDot:{x:u/2,y:-m/3,z:0},endDot:{x:u/2+y,y:-m/3,z:0}},{uuid:"",name:"ladder2",startDot:{x:u/2,y:0,z:0},endDot:{x:u/2+y,y:0,z:0}},{uuid:"",name:"ladder3",startDot:{x:u/2,y:m/3,z:0},endDot:{x:u/2+y,y:m/3,z:0}},{uuid:"",name:"ladder4",startDot:{x:u/2+y,y:-m/3,z:0},endDot:{x:u/2+2*y,y:-m/3,z:0}},{uuid:"",name:"ladder5",startDot:{x:u/2+y,y:0,z:0},endDot:{x:u/2+2*y,y:0,z:0}},{uuid:"",name:"ladder6",startDot:{x:u/2+2*y,y:-m/3,z:0},endDot:{x:u/2+3*y,y:-m/3,z:0}}]},{uuid:"",name:"wall",objType:"wall",depth:p,width:f,height:k,style:{skinColor:z,edgeColor:D},childrens:[{uuid:"",name:"wall1",startDot:{x:-u/2+f,y:m/2+k/2,z:0},endDot:{x:-u/2,y:m/2+k/2,z:0},childrens:[{op:"+",uuid:"",name:"线框",objType:"wireCube",depth:p,width:v,height:x,x:-f/2-1,y:k/2-k/3,z:0,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"线框",objType:"wireCube",depth:p,width:v,height:x,x:-f/2-1,y:k/3-k/2,z:0,skin:{skinColor:z,edgeColor:D}}]},{uuid:"",name:"wall2",startDot:{x:u/2-f,y:m/2+k/2,z:0},endDot:{x:u/2,y:m/2+k/2,z:0},childrens:[{op:"+",uuid:"",name:"线框",objType:"wireCube",depth:p,width:v,height:x,x:f/2+1,y:k/2-k/3,z:0,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"线框",objType:"wireCube",depth:p,width:v,height:x,x:f/2+1,y:k/3-k/2,z:0,skin:{skinColor:z,edgeColor:D}},{name:"TV",uuid:"",objType:"",depth:(p-g)/2-2*x,height:k/3-x,startDot:{x:u/2,y:k/2,z:-p/2+g/2},endDot:{x:u/2+5,y:k/2+m,z:-p/2+g/2},skin:{skinColor:D,edgeColor:D,skin_right:{imgurl:"tv.png"}}}]},{uuid:"",name:"wall3",height:f,startDot:{x:-u/2,y:m/2+k-f/2,z:0},endDot:{x:u/2,y:m/2+k-f/2,z:0},childrens:[{op:"-",uuid:"",name:"windowHole",objType:"",width:9*u/10,height:f+10,startDot:{x:0,y:m/2+k-f/2,z:4*-p/16},endDot:{x:0,y:m/2+k-f/2,z:4*p/16},skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"线柱",objType:"wireCube",depth:w,width:9*u/10,height:C,x:0,y:C/2+1,z:5*p/16,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"线柱",objType:"wireCube",depth:w,width:9*u/10,height:C,x:0,y:C/2+1,z:5*-p/16,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"线柱",objType:"wireCube",depth:10*p/16-w,width:w,height:C,x:9*u/20-w/2,y:3*C/2,z:0,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"线柱",objType:"wireCube",depth:10*p/16-w,width:w,height:C,x:9*-u/20+w/2,y:3*C/2,z:0,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"三角线体",objType:"triangle",x:9*-u/20+w/2,y:C,z:5*p/16,depth:w,width:w,height:C,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"三角线体",objType:"triangle",x:9*-u/20+w/2,y:C,z:5*-p/16,depth:w,width:w,height:C,rotation:[{direction:"y",degree:Math.PI}],skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"三角线体",objType:"triangle",x:9*u/20-w/2,y:C,z:5*-p/16,depth:w,width:w,height:C,rotation:[{direction:"y",degree:Math.PI}],skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"三角线体",objType:"triangle",x:9*u/20-w/2,y:C,z:5*p/16,depth:w,width:w,height:C,skin:{skinColor:z,edgeColor:D}},{uuid:"+",name:"windowGlasses",objType:"",width:9*u/10,height:f,startDot:{x:0,y:m/2+k-f/2,z:4*-p/16},endDot:{x:0,y:m/2+k-f/2,z:4*p/16},skin:{skin_up:{imgurl:"glass.png",transparent:!0,opacity:.25,repeatx:!0,repeaty:!0},skin_down:{imgurl:"glass.png",transparent:!0,opacity:.25,repeatx:!0,repeaty:!0}}}]}]},{uuid:"",name:"door",objType:"face",width:b,depth:g,height:k,y:k/2+m/2,x:u/2+b/2,style:{skinColor:z,edgeColor:D},childrens:[{name:"门把",uuid:"",objType:"faceCube",depth:15,startDot:{x:u/2+b,y:k/2+m,z:5*-g/13},endDot:{x:u/2+b+5,y:k/2+m,z:5*-g/13},skin:{skinColor:D}},{name:"line1",uuid:"",objType:"line",startDot:{x:u/2+b+1,y:k/2,z:g/2},endDot:{x:u/2+b+1,y:k/2,z:-g/2},skinColor:D},{name:"line2",uuid:"",objType:"line",startDot:{x:u/2+b+1,y:9*k/10,z:g/2},endDot:{x:u/2+b+1,y:9*k/10,z:-g/2},skinColor:D},{name:"line3",uuid:"",objType:"line",startDot:{x:u/2+b+1,y:k+m/2,z:g/4},endDot:{x:u/2+b+1,y:m/2,z:g/4},skinColor:D},{name:"line4",uuid:"",objType:"line",startDot:{x:u/2+b+1,y:k+m/2,z:-g/4},endDot:{x:u/2+b+1,y:m/2,z:-g/4},skinColor:D}]},{show:!0,uuid:"",name:"camera",objType:"objCamera",childrens:[{name:"camera-one",uuid:"",x:-u/2+70,y:k+30,z:p/2-20,objHandle:[{direction:"arb",handleScale:[.6,.6,.6],handleRotale:[0,1,0,.5*Math.PI]},{direction:"z",degree:.5*Math.PI}]},{name:"camera-two",uuid:"",x:-u/2+70,y:k+30,z:-p/2+20,objHandle:[{direction:"arb",handleScale:[.6,.6,.6],handleRotale:[0,1,0,.5*Math.PI]},{direction:"z",degree:-.5*Math.PI}]}]}],events:{dbclick:[],mouseDown:{},mouseUp:{},mouseMove:{}},btns:[]},O=10,S=(u-2*f-(O+1)*x)/O,T={uuid:"",name:"Rack1",width:S,height:k-f,depth:p/3,x:-u/2+f+S/2,y:m/2+k/2-f/2,z:p/3,data:{name:"",devid:"01",pointid:"0101",isalarm:!1,tipInfo:"设备1信息***",alarmInfo:""},childrens:[{op:"+",uuid:"",name:"线框",objType:"wireCube",depth:v,width:S,height:x,x:0,y:k/2-k/3+f/2,z:p/6+1,skin:{skinColor:z,edgeColor:D}},{op:"+",uuid:"",name:"线框",objType:"wireCube",depth:v,width:S,height:x,x:0,y:f/2-(k/2-k/3),z:p/6+1,skin:{skinColor:z,edgeColor:D}}]},L={op:"+",uuid:"",name:"线框",objType:"wireCube",depth:p/3,width:x,height:v,x:0,y:f/2+1,z:p/3,skin:{skinColor:z,edgeColor:D}},N=[],M={uuid:"",name:"柜子",objType:"rack",depth:p/3,height:k-f,style:{skinColor:z,edgeColor:D},childrens:[]},_=0;_<O;_++){var P=JSON.parse(JSON.stringify(T));if(P.name="Rack"+(_+1),P.data.name="JG-"+(_+1),P.data.tipInfo="精密空调柜-"+(_+1),P.data.devid=P.data.devid+_,P.data.pointid=P.data.pointid+_,P.x=-u/2+f+S/2+S*_+(_+1)*x,M.childrens.push(P),_>0){var E=JSON.parse(JSON.stringify(L));E.x=-u/2+f+S*_+(_+.5)*x,N.push(E)}}j.objects.push(M),j.objects[2].childrens[2].childrens=N.concat(j.objects[2].childrens[2].childrens);var H=[],I={uuid:"",name:"柜子",objType:"rack",depth:p/3,height:k-f,style:{skinColor:z,edgeColor:D},childrens:[]};for(_=0;_<O;_++){var F=JSON.parse(JSON.stringify(T));if(F.name="Rack"+(_+10),F.data.name="JG-"+(_+10),F.data.tipInfo="精密空调柜-"+(_+1+10),F.data.devid=F.data.devid+(_+10),F.data.pointid=F.data.pointid+(_+10),F.x=-u/2+f+S/2+S*_+(_+1)*x,F.z=-p/3,F.childrens.forEach((function(e){e.z=-(p/6+1)})),I.childrens.push(F),_>0){var q=JSON.parse(JSON.stringify(L));q.x=-u/2+f+S*_+(_+.5)*x,q.z=-p/3,H.push(q)}}j.objects.push(I),j.objects[2].childrens[2].childrens=H.concat(j.objects[2].childrens[2].childrens);var R={name:"index",created:function(){for(var e=0;e<20;e++)for(var t=0;t<this.baseInfo.length;t++){var o=JSON.parse(JSON.stringify(this.baseInfo[t]));o.devid=this.baseInfo[t].devid+e,o.pointid=this.baseInfo[t].pointid+e,o.name="精密空调-"+(e+1),o.id=o.devid+o.pointid,this.equipment.push(o),this.alarm.push("1")}},mounted:function(){var e={domID:"three-dom"};this.map=new c(e,j),this.map.init()},data:function(){return{map:null,dialogVisible:!1,baseInfo:[{devid:"01",pointid:"0101",name:"",level:"1",id:"",alarmInfo:"",isalarm:!1}],alarmInfo:[{id:"1",name:"提示"},{id:"2",name:"次要"},{id:"3",name:"重要"},{id:"4",name:"严重"},{id:"5",name:"紧急"}],equipment:[],alarm:[],equipmentList:[],equipmentList1:[]}},methods:{set:function(){this.equipmentList=[],this.equipmentList1=[],this.dialogVisible=!0},sure:function(){for(var e=[],t=0;t<this.equipment.length;t++){for(var o=0;o<this.equipmentList.length;o++)if(this.equipmentList[o]==this.equipment[t].id){var i=JSON.parse(JSON.stringify(this.equipment[t]));i.isalarm=!0,i.level=this.alarm[t],i.alarmInfo="温度过高告警",e.push(i)}for(var n=0;n<this.equipmentList1.length;n++)this.equipmentList1[n]==this.equipment[t].id&&e.push(this.equipment[t])}console.log(e),this.map.updateAlarmStatus(e),this.dialogVisible=!1}},components:{}},A=R,V=(o("fc65"),o("2877")),G=Object(V["a"])(A,i,n,!1,null,"69e473d6",null);t["default"]=G.exports},d396:function(e,t,o){},fc65:function(e,t,o){"use strict";var i=o("d396"),n=o.n(i);n.a}}]);